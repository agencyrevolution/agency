#!/usr/bin/env bash
# Usage: agency portal
# Summary: Open, edit or preview a portal
# Help: Open, edit or preview a portal
#
#    agency portal [images] [name]
#    agency portal [edit] [name]
#    agency portal [sass] [name]
#    agency portal [js] [name]
#    agency portal [view] [name]
#    agency portal [copy] [target] [destination]

set -e

ACTION=${1}
PORTALNAME=${2}
PORTALSDIR="$HOME/Shares/AR-Clients/Portals"
DESTPORTALNAME=${3}

case $ACTION in

	edit )
	if [ -d $PORTALSDIR/$PORTALNAME ]; then
		cd $PORTALSDIR/$PORTALNAME/
		$EDITOR .
	else
		echo "Portal $PORTALNAME does not exist"
	fi
	;;

	sass )
	if [ -f $PORTALSDIR/$PORTALNAME/sass/portal.scss ]; then
		$EDITOR $PORTALSDIR/$PORTALNAME/sass/portal.scss
  elif [ -f $PORTALSDIR/$PORTALNAME/sass/portal2.scss ]; then
		$EDITOR $PORTALSDIR/$PORTALNAME/sass/portal2.scss
  else
    echo "Sass files do not exist in this portal"
	fi
	;;

	js )
	if [ -f $PORTALSDIR/$PORTALNAME/portal.js ]; then
		$EDITOR $PORTALSDIR/$PORTALNAME/portal.js
  elif [ -f $PORTALSDIR/$PORTALNAME/portal2.js ]; then
		$EDITOR $PORTALSDIR/$PORTALNAME/portal2.js
  else
    echo "Javascript files do not exist in this portal"
	fi
	;;

	images )
	if [ -d $PORTALSDIR/$PORTALNAME/images ]; then
		cd $PORTALSDIR/$PORTALNAME/images && ls
	else
		echo "Images folder does not exist"
	fi
	;;

	view )
	open http://$PORTALNAME.agencyrevolution.com
	;;
  
  copy )
  for FILE in config.rb Gemfile portal.js portal2.js portal.css portal2.css sass/portal.scss sass/portal2.scss
  do
    if [ -f $PORTALSDIR/$DESTPORTALNAME/$FILE ]; then
      rm -rf $PORTALSDIR/$DESTPORTALNAME/$FILE
      cp $PORTALSDIR/$PORTALNAME/$FILE $PORTALSDIR/$DESTPORTALNAME/$FILE
    else
      echo "$FILE does not exist"
  done
  ;;

esac

